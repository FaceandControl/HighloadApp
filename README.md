# HighloadApp
# 1) Діаграма Архітектури 
![Untitled Diagram drawio (1)](https://user-images.githubusercontent.com/116028370/231503712-104c4f98-ace7-4a70-8ef2-548975e8bdfa.png)

[Натисніть, щоб переглянути діаграму](https://drive.google.com/file/d/1V6ukZNQ0xZvV-zXFWAwC449OCjpM4tgS/view?usp=sharing)

# 2) Структура Бази Даних 
![image](https://user-images.githubusercontent.com/116028370/231772653-588f6b23-0f1d-40cd-97fb-e81f7005cbf7.png)

# 3) Опис Архітектури 
 Була обрана Безсерверна архітектура на платформі Micrososft Azure для легкої масштабованості, простоти деплою проєкту та легкості додавання нової логіки
 (функцій, тригерів, сервісів). Також дана платформа охоплює засоби для роботи з різноманітним функціоналом таким як:
 створення і моніторинг черг, підключення та менеджмент сховищ даних, змога приєднати статистичний моніторинг (Логери, App Insights), 
 взаємодія з кешованими даними (Redis Cash).
 
# 4) Перелік та короткий опис функцій 
 * ***Video Metadata Function*** - Функція що вертає повну інформацію про певне відео, шляхом витягування даних з сховища даних по айді відео. 
 Зберігає дані в кеші, щоб зменшити час повторного запиту для цього відео.
 
 * ***User Profile Function*** - Функція що обробляє круд операції над юзером. Запит на перегляд інформації про юзера витягує потрібні дані каналу 
 зі сховища даних, а також зберігає їх в кеші. Запити на створення/редагування юзера відправляють пейлоад ріквесту до спеціальної черги 
 (Profile CUD Queue), де ці дані обробляє спеціальний тригер - Crud Profile Triger. Також завдяки цій функції з бази даних + кеш,
 можна витягнути перелік відео поточного каналу.
 
 * ***Video Recommendations Function*** - Події перегляду та лайку відео потрапляють в Azure SQL, а потім завантажуються в Azure DataBricks для подальшого використання в Recommendation AI model.За допомогою CRON функції дані щоденно обраховуються та записуються в Redis Cache. При зверненні до Recommendation функції дані дістаються з кешу або ж обраховуються в AI моделі

 * ***Video Statistics Function*** - Функція яка через ріквест до Databricks витягає статистичні дані (лайки, перегляди, дізлайки) до вказаного відео. 
 Статистика кешується.
 
 * ***Video Search Function*** - Функція яка відправляє ріквест з переліком фільтрів до Elasctic Search, який, за допомогою цих фільтрів та індексуванню по юзерах 
 та відео, повертає список відповідних до запиту відео 
 
 * ***Video Upload Status Function*** - Функція яка допомагає переглянути статус завантаження відео через звернення до Cosmos Db
 (сховище даних в яке записується інформація з Video Encod Service)
 
 * ***Video Like Function*** - Функція що при натисканні на клавішу лайк редагує кількість лайків на відео. 
 Після натискання на клавішу відправляється ріквест з даними до Video CD Likes Queue, звідки CD Likes Trigger грабає дані і на основі них апдейтить сховище даних.
 
 * ***Video Comment Function*** - Функція що допомагає провести круд операції над коментарями/сабкоментарями під відео, аналогічна обробка запиту як в 
 функції для лайків.
 
 * ***User Subscription Function*** - Функція що допомагає підписатися на певний канал, аналогічна обробка запиту як в функції для лайків.
 
 * ***Video Playback Function*** - Функція яка за айді відео витягує фрагментовано (розбито по часовим фреймам) закодоване відео , 
 а також фіксує в кеші переглянутий фрагмент відео (його часові проміжки), після перегляду фрагментує відео іде запит на наступний фрагмент відео і так далі. 
 
 * ***Populate Video Recommendations Cache Function*** - Функція що збирає кеш юзерів (переглянуті хештеги, лайки) і оновлює статистичну інформацію 
 
 * ***Populate Video Statistics Cache Function*** - Функція що збирає кеш юзерів (лайки, перегляди) і оновлює статистичну інформацію 
 для роботи Recommendation AI Model
 
 * ***Index Videos/Users Function*** - Функція яка за допомогою певних індексів вертає найбільш популярні відео або юзерів.

# 5) Перелік та короткий опис сервісів 
 * ***Video Upload Service*** - Функція що дозволяє завантажити відео з повною його інформацією на канал, 
 шляхом його кодування і збереження метаданих в сховище даних/блоб 
 
 * ***Video Encode Service*** - Функція яка кодує відео і зберігає інформацію в блоб сховище.
 
# 6) Ендпоінти перелічених функцій та сервісів

![image](https://user-images.githubusercontent.com/116028370/232849139-9227e9e3-c196-41c1-85ef-527db3bf4782.png)
 
# 7) Перелік та короткий опис тригерів 
 * ***CRUD Profile Trigger*** - Тригер що оновлює інформацію в базі на основі нових айтемів в черзі - Profile CUD Operations Queue
 
 * ***CRUD Subscripton Trigger*** - Тригер що оновлює інформацію в базі на основі нових айтемів в черзі - Video CD Likes Queue
 
 * ***CRUD Comments Trigger*** - Тригер що оновлює інформацію в базі на основі нових айтемів в черзі - Video CUD Comments Queue
 
 * ***CRUD Likes Trigger*** - Тригер що оновлює інформацію в базі на основі нових айтемів в черзі - User CD Subscription Queue
 
Детальний опис вище переліченого функціонала детальніше буде описаний в [презентації](https://docs.google.com/presentation/d/1YNw-F2N59Y4scI_A1Rn8NuguFu_ymmpI5ujL5Rk4pm8/edit?usp=sharing)
